@name Radio Transmitter Implementation
@inputs 
@outputs PlayList:array
@persist PlayList:array
@trigger RadioSlave

#include "Radio_Transmitter"

if (first() || dupefinished()) {
    #This is the radio's unique channel used to send out music.  
    RadioData["Channel",string] = "Naroii_Beats"         
    RadioData["Name",string] = "Naroii Beats"
    RadioData["Description",string] = "Cool beats"
    
    #Common group used to get info about available radio stations.
    RadioNetworkAddress = "RADIOGROUP1"         
        
    PlayList = array(
        "https://www.youtube.com/watch?v=-0hWUGY5Bfs",
        "https://www.youtube.com/watch?v=MwEXpP8vZD4",       
        "https://www.youtube.com/watch?v=OVdWB-MhNxU"
    )
    
    runOnChat(1)
    
    function playSongFromPlayList() {
        setURL(PlayList[1,string])
        
        PlayList:remove(1)     
    }
    
    setupDS()
    playSongFromPlayList() 
    
    timer("CheckCurrentSong", 1000)
} elseif (clk("CheckCurrentSong")) {    
    if (RadioSlave["Ended",number]) {
        playSongFromPlayList()
    }

    timer("CheckCurrentSong", 1000)
} elseif (chatClk(owner())) {
    local LastSaid = lastSaid()
    
    if (LastSaid:find("!add") == 1) { 
        PlayList:pushString(LastSaid:sub(5):trim())
        
        hideChat(1)
    }    
}
